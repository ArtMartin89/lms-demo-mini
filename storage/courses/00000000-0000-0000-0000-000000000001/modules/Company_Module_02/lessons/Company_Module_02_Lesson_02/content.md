# Урок 2: Обработка данных для ML

## Важность данных

Качество данных напрямую влияет на качество модели. Плохие данные = плохая модель.

## Этапы обработки данных

### 1. Сбор данных

- Определить источники данных
- Собрать релевантную информацию
- Убедиться в достаточном объеме

### 2. Очистка данных

#### Обработка пропусков

- **Удаление**: Если пропусков мало
- **Заполнение**: Средним, медианой, модой
- **Предсказание**: Использование ML для заполнения

#### Обработка выбросов

- **Обнаружение**: Статистические методы (IQR, Z-score)
- **Удаление или трансформация**: В зависимости от задачи

### 3. Нормализация и стандартизация

#### Нормализация (Min-Max Scaling)

Приводит значения к диапазону [0, 1]:

```
x_norm = (x - min) / (max - min)
```

#### Стандартизация (Z-score)

Приводит к среднему 0 и стандартному отклонению 1:

```
x_std = (x - mean) / std
```

### 4. Кодирование категориальных признаков

#### One-Hot Encoding

Создает бинарные признаки для каждой категории:

```
Красный → [1, 0, 0]
Синий   → [0, 1, 0]
Зеленый → [0, 0, 1]
```

#### Label Encoding

Присваивает числовые метки:

```
Красный → 0
Синий   → 1
Зеленый → 2
```

### 5. Разделение данных

#### Тренировочный набор (60-80%)

Используется для обучения модели

#### Валидационный набор (10-20%)

Используется для настройки гиперпараметров

#### Тестовый набор (10-20%)

Используется для финальной оценки

## Feature Engineering

### Создание новых признаков

- **Комбинации**: Умножение, деление признаков
- **Полиномиальные**: x², x³
- **Временные**: Извлечение дня недели, месяца
- **Текстовые**: TF-IDF, word embeddings

### Отбор признаков

- **Фильтрация**: По корреляции, важности
- **Обертка**: Поиск оптимального подмножества
- **Встроенные методы**: L1-регуляризация

## Работа с несбалансированными данными

### Проблема

Один класс значительно превосходит другой

### Решения

- **Oversampling**: Увеличение меньшего класса
- **Undersampling**: Уменьшение большего класса
- **SMOTE**: Синтетическое создание примеров
- **Взвешивание классов**: При обучении модели

## Заключение

Правильная обработка данных — это основа успешного машинного обучения. Большую часть времени ML-специалисты тратят именно на подготовку данных.

